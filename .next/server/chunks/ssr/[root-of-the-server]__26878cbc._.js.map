{"version":3,"sources":["../../../../../../../../Developer/freelance/exim/exim/app/global-products/Hero.js/__nextjs-internal-proxy.mjs","../../../../../../../../Developer/freelance/exim/exim/app/global-products/%5Bproducts%5D/%5Bcountry%5D/%5Btype%5D/%5Bpage%5D/Products.js/__nextjs-internal-proxy.mjs","../../../../../../../../Developer/freelance/exim/exim/app/global-products/%5Bproducts%5D/%5Bcountry%5D/%5Btype%5D/%5Bpage%5D/page.js","../../../../../../../../Developer/freelance/exim/exim/lib/globalProducts.js"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/Developer/freelance/exim/exim/app/global-products/Hero.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Developer/freelance/exim/exim/app/global-products/Hero.js\",\n    \"default\",\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/Developer/freelance/exim/exim/app/global-products/[products]/[country]/[type]/[page]/Products.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Developer/freelance/exim/exim/app/global-products/[products]/[country]/[type]/[page]/Products.js\",\n    \"default\",\n);\n","import Hero from \"@/app/global-products/Hero\";\nimport Products from \"./Products\";\nimport { getGlobalProducts } from \"@/lib/globalProducts\";\n\nexport const revalidate = 3600;\n\nexport async function generateMetadata({ params }) {\n  params = await params;\n\n  const { products, country, type, page } = params;\n\n  const letter = products.replace(\"product-\", \"\").toUpperCase();\n  const readableCountry = country.replace(\"country-\", \"\").replace(/_/g, \" \");\n  const trade = type.replace(\"type-\", \"\");\n\n  return {\n    title: `${readableCountry} ${trade} Products Starting With ${letter}`,\n    alternates: {\n      canonical: `https://eximtradedata.com/global-products/${products}/${country}/${type}/${page}`,\n    },\n  };\n}\n\nexport default async function Page({ params }) {\n  params = await params;\n\n  const letter = params.products.replace(\"product-\", \"\");\n  const country = params.country.replace(\"country-\", \"\");\n  const type = params.type.replace(\"type-\", \"\");\n  const page = Number(params.page.replace(\"pg-\", \"\")) || 1;\n\n  const data = await getGlobalProducts({\n    letter,\n    country,\n    type,\n    page,\n  });\n\n  const normalizeCountry = (v) =>\n  v\n    .replace(/_/g, \" \")\n    .toLowerCase()\n    .replace(/\\b\\w/g, (c) => c.toUpperCase());\n\n  return (\n    <main>\n      <Hero heading={`Products Starting With ${letter.toUpperCase()}`} />\n\n      \n\n<Products\n  defaultLetter={letter}\n  defaultCountry={normalizeCountry(country)}\n  defaultTradeType={type === \"import\" ? \"Import\" : \"Export\"}\n  currentPage={page}\n  products={data.products}\n  totalValues={data.total}\n/>\n    </main>\n  );\n}","import redis from \"@/lib/redis\";\n\nconst UPSTREAM = \"http://103.30.72.94:8011/countriesProductList\";\nconst AUTH = \"Basic YWJjOmFiY0AxMjM=\";\nconst CACHE_TTL = 60 * 60 * 24 * 15; // 15 days\n\nexport async function getGlobalProducts({\n  letter,\n  country,\n  type,\n  page,\n  size = 100,\n}) {\n  const redisKey = `global-products:${letter}:${country}:${type}:${page}`;\n\n  /* ---------- Redis HIT ---------- */\n  try {\n    const cached = await redis.get(redisKey);\n    if (cached) {\n      return JSON.parse(cached);\n    }\n  } catch {\n    // Redis failure should NOT break page\n  }\n\n  /* ---------- Build payload ---------- */\n  const payload = {\n    source: \"countries_product\",\n    type: \"list\",\n    size,\n    filters: letter.toUpperCase(),\n    columns: `${country}_${type}_on`,\n  };\n\n  /* ---------- Upstream fetch ---------- */\n  try {\n    const res = await fetch(UPSTREAM, {\n      method: \"POST\",\n      headers: {\n        Authorization: AUTH,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(payload),\n      cache: \"no-store\",\n    });\n\n    if (!res.ok) {\n      return { products: [], total: 0 };\n    }\n\n    const json = await res.json();\n\n    const safeData = {\n      products: Array.isArray(json?.data)\n        ? json.data.map((i) => ({ product: i.product }))\n        : [],\n      total: Number(json?.total_values) || 0,\n    };\n\n    /* ---------- Cache ---------- */\n    redis.set(redisKey, JSON.stringify(safeData), \"EX\", CACHE_TTL).catch(() => {});\n\n    return safeData;\n  } catch {\n    return { products: [], total: 0 };\n  }\n}"],"names":[],"mappings":"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","ignoreList":[0,1]}